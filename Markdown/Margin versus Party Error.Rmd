---
title: "Margin Versus Party Error"
author: "Haley Reed"
date: "7/3/2020"
output: html_document
bibliography: electionworkingbib.bib
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, error=FALSE, warning=FALSE)
knitr::opts_knit$set(root.dir = dirname(getwd()))
```


**Introduction**

In looking at past polls and elections, the "bias" of a poll is defined around the margin of difference between the two primary candidates of a race. 

What is the relationship between that "bias" and the actual number of percentage points a particular poll is off in judging candidates in a vacuum? 

What is the relationship between Republican Error, Democratic error, and traditional bias with the following definitions?

$$DemocraticError = DemocraticCanditatePollingPercent-DemocraticActualPercentage$$

$$RepublicanError = RepublicanCanditatePollingPercent-RepublicanActualPercentage$$

$$Bias = MarginPoll - MarginActual$$

$$MarginPoll = DemocraticCanditatePollingPercent-RepublicanCanditatePollingPercent$$
$$MarginActual = DemocraticActualPercentage-RepublicanActualPercentage$$
Before we get into Bayesian modeling it worth doing some inital exploration with Fisherian statistics...

```{r}
mydata=read.csv("Data/raw-polls_538_cleaned.csv")
#is year rep. lean = -(dem. year lean) ?
minPolls=30
myDataMyPollsters=  mydata[0,]
for(myPollster in unique(mydata$pollster))
{
  
  #subset to a dataset with just each pollster
  subpoll=subset(mydata, pollster==myPollster)
  
  #if that subset has more than thirty entries, use it:
  if(nrow(subpoll)>minPolls){
    #combine each of these subsets together
    myDataMyPollsters=rbind(myDataMyPollsters, subpoll)
  }
}
myDataFrame = myDataMyPollsters
myDataFrame$pollster = factor( myDataFrame$pollster)
lm(formula = myDataFrame$repBias ~ myDataFrame$demBias)
lm(formula =  myDataFrame$demBias ~ myDataFrame$repBias)
plot(myDataFrame$repBias, myDataFrame$demBias, xlab="Republican Error", ylab="Democratic Error", Main="Errors Dependent on each other, Matched By Poll")
corrval=cor(myDataFrame$repBias, myDataFrame$demBias)
corrval1=cor(myDataFrame$demBias, myDataFrame$bias)
corrval2=cor(myDataFrame$repBias, myDataFrame$bias)
lm(myDataFrame$bias~myDataFrame$demBias)
```

With a correlation value of `r corrval` between Democratic error and Republican error, we can see that the two are moderately correlated.

However, there is a higher correlation between party errors and bias measured in the traditional marginal sense is stronger. The correlation between democratic error and bias is `r corrval1`. And the correlation between republican error and bias is `r corrval2`. 

```{r, include=FALSE, fig.show='hide'}
source(here::here('RScripts', 'Exploration of Margin v. Party Error.r'))
```

Democratic and Republican year leans are shown below for comparison. As well as these year leans plotted together...
```{r}
knitr::kable(dtD)
knitr::kable(dtR)

plot(dtD$yearLabels,dtD$Mode, col="blue", main="Year Leans", xlab="Election Year", 
     ylab="Most Credible Error Value", ylim=c(-5, 1) , xlim=c(1996, 2020), xaxt = "n"
     )
# Define the position of tick marks
axis(side = 1, 
     at = yearLabels, 
     labels = yearLabels,
     tck=-.05)
points(dtR$yearLabels, dtR$Mode, col="red")
# Add a legend
legend(1996, 1, legend=c("Democratic Error", "Republican Error"),
       col=c("blue", "red"), lty=1:2, cex=0.8)
```




For matching points by year and pollster, the relationship between Democratic error and republican error does not look very strong....

In fact the R squared values is less than 0.


```{r}
plot(dtDpollster$Mode,dtRpollster$Mode, main="Democratic Versus Rebulican Pollster Biases, 2000-2016", xlab="Democratic Pollster Bias", 
     ylab="Republican Pollster Bias")
```

**Conclusion**

The relationships between Republican Error, Democratic error, and traditional bias are not as strong as we might initally think. 

\newpage

**Works Cited**

---
#.bib for bib refrence
nocite: |
  @538rawpolldata
  @KrusckeTextbook
---